## MappingData

Лёгкое веб‑приложение на FastAPI для извлечения и визуализации данных из Excel/PDF (таможенные декларации и инвойсы). Загружаете файл — получаете структурированную таблицу и расчёты с использованием единого алгоритма обработки.

### Демо
Открыть: `https://data-mapping-tool-15n5.onrender.com`

### Возможности
- **Загрузка** Excel/PDF через веб‑интерфейс.
- **Обработка** данными единым алгоритмом.
- **Просмотр** результатов в виде таблицы + агрегаты/итоги.
- **Сравнение**: инвойс с таможенной декларацией.

### Стек
- **Backend**: FastAPI, Uvicorn
- **Шаблоны**: Jinja2 (`templates/`)
- **Docker**: запуск в режиме разработки через `docker-compose.yml`
- **Деплой**: Render (`render.yaml`)

### Структура проекта
```
mappingdata/
├── main.py                 # Точка входа (uvicorn main:app)
├── docker-compose.yml      # Docker dev‑запуск
├── requirements.txt        # Зависимости Python
├── render.yaml             # Конфигурация деплоя на Render
├── src/
│   ├── api.py              # FastAPI маршруты и HTML‑страницы
│   ├── models.py           # Pydantic‑модели запросов/данных
│   ├── services.py         # Логика обработки и сохранения данных
│   ├── processors/         # Алгоритмы парсинга
│   │   ├── __init__.py     # Регистрация PROCESSORS
│   │   └── unified.py      # Единый алгоритм обработки
│   └── compare/            # Логика сравнения инвойс/декларация
│       ├── __init__.py     # Доступ к COMPARE_HANDLERS
│       └── unified_compare.py # Единый алгоритм сравнения
├── templates/              # HTML‑шаблоны (upload/table/compare)
└── static/                 # Статические файлы
```

### Установка и запуск

Вариант A — Docker (рекомендуется, один старт‑командой):
```bash
docker-compose up --build
```
Приложение будет доступно на `http://127.0.0.1:8000`.

Вариант B — Локально (без Docker):
```bash
python -m venv .venv
. .venv/Scripts/activate  # Windows PowerShell: .venv\Scripts\Activate.ps1
pip install -r requirements.txt
uvicorn main:app --reload
```
Откройте `http://127.0.0.1:8000`.

### Как пользоваться
1. Откройте главную страницу (`/`).
2. Загрузите файл Excel и дождитесь обработки единым алгоритмом.
3. Перейдите на страницу таблицы (`/table`) для просмотра данных и итогов.
4. Для сравнения инвойса и декларации используйте `/compare`.

### Архитектура
Проект использует единый алгоритм обработки (`unified.py`) и единый алгоритм сравнения (`unified_compare.py`). Все данные обрабатываются одинаково независимо от источника.

### Деплой на Render
- Репозиторий собирается Docker‑ом автоматически. Конфигурация — `render.yaml`.
- Переменные окружения и команду запуска можно указать в панели Render, команда по умолчанию: `uvicorn main:app --host 0.0.0.0 --port 8000`.

### Лицензия
MIT